// SKYFIRE Competition Internationalization (i18n)

// Language translations
const translations = {
    en: {
        // Navigation
        'nav.home': 'Home',
        'nav.registration': 'Registration',
        'nav.evaluation': 'Evaluation',
        'nav.patterns': 'Patterns',
        'nav.promote': 'Promote',
        'nav.laser-kits': 'Laser Kits',
        
        // Main Content
        'hero.title': 'SKYFIRE DIY Fiber Laser Cutter Competition 2024-2025',
        'hero.subtitle': 'ðŸ† Join the Global Maker Community - Showcase Your DIY Fiber Laser Cutting Skills',
        'hero.description': 'ðŸŒ International Competition with $5,800 Prize Pool - Registration Deadline Sep 30, 2025',
        'hero.register-btn': 'Register Now',
        'hero.learn-more': 'Learn More',
        
        // Statistics
        'stats.participants': 'Participants Registered',
        'stats.refresh': 'Refresh',
        'stats.prize-pool': 'Total Prize Pool: $5,800 Gift Vouchers',
        
        // Timeline
        'timeline.title': 'Competition Timeline',
        'timeline.registration': 'Registration',
        'timeline.evaluation': 'Evaluation',
        'timeline.results': 'Results',
        'timeline.reg-deadline': 'Sep 30, 2025',
        'timeline.eval-start': 'Nov 30, 2025', 
        'timeline.results-date': 'Dec 15, 2025',
        
        // Form
        'form.name': 'Full Name',
        'form.email': 'Email Address',
        'form.country': 'Country/Region',
        'form.phone': 'Phone Number (Optional)',
        'form.company': 'Company/Organization',
        'form.participation': 'Participation Type',
        'form.individual': 'Individual',
        'form.team': 'Team',
        'form.power-level': 'Laser Power Level',
        'form.source': 'How did you hear about us?',
        'form.agree': 'I agree to the competition terms',
        'form.submit': 'Register Now',
        
        // Messages
        'msg.loading': 'Loading...',
        'msg.success': 'Registration successful!',
        'msg.error': 'An error occurred',
        'msg.copied': 'Copied to clipboard!',
        'msg.draft-restored': 'Draft restored',
        
        // Footer
        'footer.contact': 'Contact',
        'footer.copyright': 'Â© 2025 SKYFIRE DIY Fiber Laser Cutter Competition. All rights reserved.',
        'footer.tagline': 'Designed for makers, by makers. Join the innovation revolution.'
    },
    
    zh: {
        // Navigation
        'nav.home': 'é¦–é¡µ',
        'nav.registration': 'æŠ¥å',
        'nav.evaluation': 'è¯„ä¼°',
        'nav.patterns': 'å›¾æ¡ˆ',
        'nav.promote': 'æŽ¨å¹¿',
        'nav.laser-kits': 'æ¿€å…‰è®¾å¤‡',
        
        // Main Content  
        'hero.title': 'SKYFIRE DIYå…‰çº¤æ¿€å…‰åˆ‡å‰²æœºå¤§èµ› 2024-2025',
        'hero.subtitle': 'ðŸ† åŠ å…¥å…¨çƒåˆ›å®¢ç¤¾åŒº - å±•ç¤ºæ‚¨çš„DIYå…‰çº¤æ¿€å…‰åˆ‡å‰²æŠ€èƒ½',
        'hero.description': 'ðŸŒ å›½é™…æ¯”èµ›ï¼Œ5800ç¾Žå…ƒå¥–é‡‘æ±  - æŠ¥åæˆªæ­¢æ—¥æœŸï¼š2025å¹´9æœˆ30æ—¥',
        'hero.register-btn': 'ç«‹å³æŠ¥å',
        'hero.learn-more': 'äº†è§£æ›´å¤š',
        
        // Statistics
        'stats.participants': 'å‚èµ›è€…å·²æ³¨å†Œ',
        'stats.refresh': 'åˆ·æ–°',
        'stats.prize-pool': 'æ€»å¥–é‡‘æ± ï¼š5800ç¾Žå…ƒç¤¼å“åˆ¸',
        
        // Timeline
        'timeline.title': 'æ¯”èµ›æ—¶é—´çº¿',
        'timeline.registration': 'æŠ¥å',
        'timeline.evaluation': 'è¯„ä¼°',
        'timeline.results': 'ç»“æžœ',
        'timeline.reg-deadline': '2025å¹´9æœˆ30æ—¥',
        'timeline.eval-start': '2025å¹´11æœˆ30æ—¥',
        'timeline.results-date': '2025å¹´12æœˆ15æ—¥',
        
        // Form
        'form.name': 'å§“å',
        'form.email': 'é‚®ç®±åœ°å€',
        'form.country': 'å›½å®¶/åœ°åŒº',
        'form.phone': 'ç”µè¯å·ç ï¼ˆå¯é€‰ï¼‰',
        'form.company': 'å…¬å¸/ç»„ç»‡',
        'form.participation': 'å‚èµ›ç±»åž‹',
        'form.individual': 'ä¸ªäºº',
        'form.team': 'å›¢é˜Ÿ',
        'form.power-level': 'æ¿€å…‰åŠŸçŽ‡ç­‰çº§',
        'form.source': 'æ‚¨æ˜¯å¦‚ä½•äº†è§£æˆ‘ä»¬çš„ï¼Ÿ',
        'form.agree': 'æˆ‘åŒæ„æ¯”èµ›æ¡æ¬¾',
        'form.submit': 'ç«‹å³æŠ¥å',
        
        // Messages
        'msg.loading': 'åŠ è½½ä¸­...',
        'msg.success': 'æ³¨å†ŒæˆåŠŸï¼',
        'msg.error': 'å‘ç”Ÿé”™è¯¯',
        'msg.copied': 'å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼',
        'msg.draft-restored': 'è‰ç¨¿å·²æ¢å¤',
        
        // Footer
        'footer.contact': 'è”ç³»æˆ‘ä»¬',
        'footer.copyright': 'Â© 2025 SKYFIRE DIYå…‰çº¤æ¿€å…‰åˆ‡å‰²æœºå¤§èµ›ã€‚ç‰ˆæƒæ‰€æœ‰ã€‚',
        'footer.tagline': 'ä¸ºåˆ›å®¢è€Œè®¾è®¡ï¼Œç”±åˆ›å®¢æ‰“é€ ã€‚åŠ å…¥åˆ›æ–°é©å‘½ã€‚'
    }
};

// Current language
let currentLanguage = localStorage.getItem('skyfire-language') || 'en';

// Get translation
function t(key) {
    return translations[currentLanguage]?.[key] || translations.en[key] || key;
}

// Set language
function setLanguage(lang) {
    if (translations[lang]) {
        currentLanguage = lang;
        localStorage.setItem('skyfire-language', lang);
        updatePageText();
        updateLanguageSelector();
        
        // Trigger custom event for other scripts
        window.dispatchEvent(new CustomEvent('languageChanged', { detail: { language: lang } }));
    }
}

// Update all text on page
function updatePageText() {
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        const translation = t(key);
        
        if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
            if (element.type === 'submit' || element.type === 'button') {
                element.value = translation;
            } else {
                element.placeholder = translation;
            }
        } else {
            element.textContent = translation;
        }
    });
    
    // Update document title
    const titleKey = document.querySelector('[data-i18n-title]')?.getAttribute('data-i18n-title');
    if (titleKey) {
        document.title = t(titleKey);
    }
}

// Update language selector
function updateLanguageSelector() {
    document.querySelectorAll('.language-selector select').forEach(select => {
        select.value = currentLanguage;
    });
    
    document.querySelectorAll('.language-selector button').forEach(button => {
        const lang = button.getAttribute('data-lang');
        button.classList.toggle('active', lang === currentLanguage);
    });
}

// Create language selector
function createLanguageSelector() {
    const selector = document.createElement('div');
    selector.className = 'language-selector flex items-center gap-2';
    selector.innerHTML = `
        <div class="relative">
            <select onchange="setLanguage(this.value)" class="border border-gray-300 rounded px-3 py-2 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-orange-500">
                <option value="en">ðŸ‡ºðŸ‡¸ English</option>
                <option value="zh">ðŸ‡¨ðŸ‡³ ä¸­æ–‡</option>
            </select>
        </div>
    `;
    
    return selector;
}

// Add language selector to navigation
function addLanguageSelectorToNav() {
    const nav = document.querySelector('nav .hidden.lg\\:flex');
    if (nav && !nav.querySelector('.language-selector')) {
        const selector = createLanguageSelector();
        nav.appendChild(selector);
        updateLanguageSelector();
    }
}

// Auto-detect language from browser
function detectLanguage() {
    const browserLang = navigator.language || navigator.userLanguage;
    const langCode = browserLang.split('-')[0];
    
    if (translations[langCode] && !localStorage.getItem('skyfire-language')) {
        setLanguage(langCode);
    }
}

// Initialize i18n
function initI18n() {
    detectLanguage();
    updatePageText();
    addLanguageSelectorToNav();
    
    // Add to window for global access
    window.t = t;
    window.setLanguage = setLanguage;
}

// Initialize when DOM is ready
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initI18n);
} else {
    initI18n();
} 